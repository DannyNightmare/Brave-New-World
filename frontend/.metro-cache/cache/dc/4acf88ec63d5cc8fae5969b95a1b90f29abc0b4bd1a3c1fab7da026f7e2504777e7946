{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/UserContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.UserProvider = UserProvider;\n  exports.useUser = useUser;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactJsxDevRuntime = require(_dependencyMap[1], \"react/jsx-dev-runtime\");\n  const API_URL = 'https://demerit-system-1.preview.emergentagent.com';\n  const UserContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function UserProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    const [failureData, setFailureData] = (0, _react.useState)(null);\n    const [showFailureModal, setShowFailureModal] = (0, _react.useState)(false);\n    const [hasCheckedFailures, setHasCheckedFailures] = (0, _react.useState)(false);\n    const createUser = async username => {\n      try {\n        const response = await fetch(`${API_URL}/api/users`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            username\n          })\n        });\n        const data = await response.json();\n        setUser(data);\n      } catch (error) {\n        console.error('Failed to create user:', error);\n      }\n    };\n    const refreshUser = async () => {\n      if (!user?.id) return;\n      try {\n        const response = await fetch(`${API_URL}/api/users/${user.id}`);\n        const data = await response.json();\n        setUser(data);\n      } catch (error) {\n        console.error('Failed to refresh user:', error);\n      }\n    };\n\n    // Check for quest failures and apply demerits\n    const checkQuestFailures = async () => {\n      if (!user?.id) return;\n      try {\n        const response = await fetch(`${API_URL}/api/quests/${user.id}/check-failures`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        const data = await response.json();\n        if (data.failed_quests && data.failed_quests.length > 0) {\n          setFailureData({\n            failedQuests: data.failed_quests,\n            totalDemerits: data.total_demerits\n          });\n          setShowFailureModal(true);\n          // Refresh user data after demerits have been applied\n          await refreshUser();\n        }\n      } catch (error) {\n        console.error('Failed to check quest failures:', error);\n      }\n    };\n    const dismissFailureModal = () => {\n      setShowFailureModal(false);\n      setFailureData(null);\n    };\n    (0, _react.useEffect)(() => {\n      // Auto-create a demo user for MVP\n      const initUser = async () => {\n        try {\n          const response = await fetch(`${API_URL}/api/users`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              username: 'Hero'\n            })\n          });\n          const data = await response.json();\n          setUser(data);\n        } catch (error) {\n          console.error('Failed to init user:', error);\n        } finally {\n          setLoading(false);\n        }\n      };\n      initUser();\n    }, []);\n\n    // Check for quest failures once user is loaded (only once per session)\n    (0, _react.useEffect)(() => {\n      if (user?.id && !hasCheckedFailures) {\n        setHasCheckedFailures(true);\n        // Delay the check slightly to allow the app to fully load\n        const timer = setTimeout(() => {\n          checkQuestFailures();\n        }, 1000);\n        return () => clearTimeout(timer);\n      }\n    }, [user?.id, hasCheckedFailures]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(UserContext.Provider, {\n      value: {\n        user,\n        loading,\n        refreshUser,\n        createUser,\n        failureData,\n        showFailureModal,\n        dismissFailureModal,\n        checkQuestFailures\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 5\n    }, this);\n  }\n  function useUser() {\n    const context = (0, _react.useContext)(UserContext);\n    if (context === undefined) {\n      throw new Error('useUser must be used within a UserProvider');\n    }\n    return context;\n  }\n});","lineCount":138,"map":[[8,2,51,0,"exports"],[8,9,51,0],[8,10,51,0,"UserProvider"],[8,22,51,0],[8,25,51,0,"UserProvider"],[8,37,51,0],[9,2,160,0,"exports"],[9,9,160,0],[9,10,160,0,"useUser"],[9,17,160,0],[9,20,160,0,"useUser"],[9,27,160,0],[10,2,1,0],[10,6,1,0,"_react"],[10,12,1,0],[10,15,1,0,"require"],[10,22,1,0],[10,23,1,0,"_dependencyMap"],[10,37,1,0],[11,2,1,89],[11,6,1,89,"_reactJsxDevRuntime"],[11,25,1,89],[11,28,1,89,"require"],[11,35,1,89],[11,36,1,89,"_dependencyMap"],[11,50,1,89],[12,2,3,0],[12,8,3,6,"API_URL"],[12,15,3,13],[12,18,3,16],[12,70,3,68],[13,2,49,0],[13,8,49,6,"UserContext"],[13,19,49,17],[13,35,49,20],[13,39,49,20,"createContext"],[13,45,49,33],[13,46,49,33,"createContext"],[13,59,49,33],[13,61,49,63,"undefined"],[13,70,49,72],[13,71,49,73],[14,2,51,7],[14,11,51,16,"UserProvider"],[14,23,51,28,"UserProvider"],[14,24,51,29],[15,4,51,31,"children"],[16,2,51,65],[16,3,51,66],[16,5,51,68],[17,4,52,2],[17,10,52,8],[17,11,52,9,"user"],[17,15,52,13],[17,17,52,15,"setUser"],[17,24,52,22],[17,25,52,23],[17,28,52,26],[17,32,52,26,"useState"],[17,38,52,34],[17,39,52,34,"useState"],[17,47,52,34],[17,49,52,48],[17,53,52,52],[17,54,52,53],[18,4,53,2],[18,10,53,8],[18,11,53,9,"loading"],[18,18,53,16],[18,20,53,18,"setLoading"],[18,30,53,28],[18,31,53,29],[18,34,53,32],[18,38,53,32,"useState"],[18,44,53,40],[18,45,53,40,"useState"],[18,53,53,40],[18,55,53,41],[18,59,53,45],[18,60,53,46],[19,4,54,2],[19,10,54,8],[19,11,54,9,"failureData"],[19,22,54,20],[19,24,54,22,"setFailureData"],[19,38,54,36],[19,39,54,37],[19,42,54,40],[19,46,54,40,"useState"],[19,52,54,48],[19,53,54,48,"useState"],[19,61,54,48],[19,63,54,69],[19,67,54,73],[19,68,54,74],[20,4,55,2],[20,10,55,8],[20,11,55,9,"showFailureModal"],[20,27,55,25],[20,29,55,27,"setShowFailureModal"],[20,48,55,46],[20,49,55,47],[20,52,55,50],[20,56,55,50,"useState"],[20,62,55,58],[20,63,55,58,"useState"],[20,71,55,58],[20,73,55,59],[20,78,55,64],[20,79,55,65],[21,4,56,2],[21,10,56,8],[21,11,56,9,"hasCheckedFailures"],[21,29,56,27],[21,31,56,29,"setHasCheckedFailures"],[21,52,56,50],[21,53,56,51],[21,56,56,54],[21,60,56,54,"useState"],[21,66,56,62],[21,67,56,62,"useState"],[21,75,56,62],[21,77,56,63],[21,82,56,68],[21,83,56,69],[22,4,58,2],[22,10,58,8,"createUser"],[22,20,58,18],[22,23,58,21],[22,29,58,28,"username"],[22,37,58,44],[22,41,58,49],[23,6,59,4],[23,10,59,8],[24,8,60,6],[24,14,60,12,"response"],[24,22,60,20],[24,25,60,23],[24,31,60,29,"fetch"],[24,36,60,34],[24,37,60,35],[24,40,60,38,"API_URL"],[24,47,60,45],[24,59,60,57],[24,61,60,59],[25,10,61,8,"method"],[25,16,61,14],[25,18,61,16],[25,24,61,22],[26,10,62,8,"headers"],[26,17,62,15],[26,19,62,17],[27,12,62,19],[27,26,62,33],[27,28,62,35],[28,10,62,54],[28,11,62,55],[29,10,63,8,"body"],[29,14,63,12],[29,16,63,14,"JSON"],[29,20,63,18],[29,21,63,19,"stringify"],[29,30,63,28],[29,31,63,29],[30,12,63,31,"username"],[31,10,63,40],[31,11,63,41],[32,8,64,6],[32,9,64,7],[32,10,64,8],[33,8,65,6],[33,14,65,12,"data"],[33,18,65,16],[33,21,65,19],[33,27,65,25,"response"],[33,35,65,33],[33,36,65,34,"json"],[33,40,65,38],[33,41,65,39],[33,42,65,40],[34,8,66,6,"setUser"],[34,15,66,13],[34,16,66,14,"data"],[34,20,66,18],[34,21,66,19],[35,6,67,4],[35,7,67,5],[35,8,67,6],[35,15,67,13,"error"],[35,20,67,18],[35,22,67,20],[36,8,68,6,"console"],[36,15,68,13],[36,16,68,14,"error"],[36,21,68,19],[36,22,68,20],[36,46,68,44],[36,48,68,46,"error"],[36,53,68,51],[36,54,68,52],[37,6,69,4],[38,4,70,2],[38,5,70,3],[39,4,72,2],[39,10,72,8,"refreshUser"],[39,21,72,19],[39,24,72,22],[39,30,72,22,"refreshUser"],[39,31,72,22],[39,36,72,34],[40,6,73,4],[40,10,73,8],[40,11,73,9,"user"],[40,15,73,13],[40,17,73,15,"id"],[40,19,73,17],[40,21,73,19],[41,6,74,4],[41,10,74,8],[42,8,75,6],[42,14,75,12,"response"],[42,22,75,20],[42,25,75,23],[42,31,75,29,"fetch"],[42,36,75,34],[42,37,75,35],[42,40,75,38,"API_URL"],[42,47,75,45],[42,61,75,59,"user"],[42,65,75,63],[42,66,75,64,"id"],[42,68,75,66],[42,70,75,68],[42,71,75,69],[43,8,76,6],[43,14,76,12,"data"],[43,18,76,16],[43,21,76,19],[43,27,76,25,"response"],[43,35,76,33],[43,36,76,34,"json"],[43,40,76,38],[43,41,76,39],[43,42,76,40],[44,8,77,6,"setUser"],[44,15,77,13],[44,16,77,14,"data"],[44,20,77,18],[44,21,77,19],[45,6,78,4],[45,7,78,5],[45,8,78,6],[45,15,78,13,"error"],[45,20,78,18],[45,22,78,20],[46,8,79,6,"console"],[46,15,79,13],[46,16,79,14,"error"],[46,21,79,19],[46,22,79,20],[46,47,79,45],[46,49,79,47,"error"],[46,54,79,52],[46,55,79,53],[47,6,80,4],[48,4,81,2],[48,5,81,3],[50,4,83,2],[51,4,84,2],[51,10,84,8,"checkQuestFailures"],[51,28,84,26],[51,31,84,29],[51,37,84,29,"checkQuestFailures"],[51,38,84,29],[51,43,84,41],[52,6,85,4],[52,10,85,8],[52,11,85,9,"user"],[52,15,85,13],[52,17,85,15,"id"],[52,19,85,17],[52,21,85,19],[53,6,86,4],[53,10,86,8],[54,8,87,6],[54,14,87,12,"response"],[54,22,87,20],[54,25,87,23],[54,31,87,29,"fetch"],[54,36,87,34],[54,37,87,35],[54,40,87,38,"API_URL"],[54,47,87,45],[54,62,87,60,"user"],[54,66,87,64],[54,67,87,65,"id"],[54,69,87,67],[54,86,87,84],[54,88,87,86],[55,10,88,8,"method"],[55,16,88,14],[55,18,88,16],[55,24,88,22],[56,10,89,8,"headers"],[56,17,89,15],[56,19,89,17],[57,12,89,19],[57,26,89,33],[57,28,89,35],[58,10,89,54],[59,8,90,6],[59,9,90,7],[59,10,90,8],[60,8,91,6],[60,14,91,12,"data"],[60,18,91,16],[60,21,91,19],[60,27,91,25,"response"],[60,35,91,33],[60,36,91,34,"json"],[60,40,91,38],[60,41,91,39],[60,42,91,40],[61,8,93,6],[61,12,93,10,"data"],[61,16,93,14],[61,17,93,15,"failed_quests"],[61,30,93,28],[61,34,93,32,"data"],[61,38,93,36],[61,39,93,37,"failed_quests"],[61,52,93,50],[61,53,93,51,"length"],[61,59,93,57],[61,62,93,60],[61,63,93,61],[61,65,93,63],[62,10,94,8,"setFailureData"],[62,24,94,22],[62,25,94,23],[63,12,95,10,"failedQuests"],[63,24,95,22],[63,26,95,24,"data"],[63,30,95,28],[63,31,95,29,"failed_quests"],[63,44,95,42],[64,12,96,10,"totalDemerits"],[64,25,96,23],[64,27,96,25,"data"],[64,31,96,29],[64,32,96,30,"total_demerits"],[65,10,97,8],[65,11,97,9],[65,12,97,10],[66,10,98,8,"setShowFailureModal"],[66,29,98,27],[66,30,98,28],[66,34,98,32],[66,35,98,33],[67,10,99,8],[68,10,100,8],[68,16,100,14,"refreshUser"],[68,27,100,25],[68,28,100,26],[68,29,100,27],[69,8,101,6],[70,6,102,4],[70,7,102,5],[70,8,102,6],[70,15,102,13,"error"],[70,20,102,18],[70,22,102,20],[71,8,103,6,"console"],[71,15,103,13],[71,16,103,14,"error"],[71,21,103,19],[71,22,103,20],[71,55,103,53],[71,57,103,55,"error"],[71,62,103,60],[71,63,103,61],[72,6,104,4],[73,4,105,2],[73,5,105,3],[74,4,107,2],[74,10,107,8,"dismissFailureModal"],[74,29,107,27],[74,32,107,30,"dismissFailureModal"],[74,33,107,30],[74,38,107,36],[75,6,108,4,"setShowFailureModal"],[75,25,108,23],[75,26,108,24],[75,31,108,29],[75,32,108,30],[76,6,109,4,"setFailureData"],[76,20,109,18],[76,21,109,19],[76,25,109,23],[76,26,109,24],[77,4,110,2],[77,5,110,3],[78,4,112,2],[78,8,112,2,"useEffect"],[78,14,112,11],[78,15,112,11,"useEffect"],[78,24,112,11],[78,26,112,12],[78,32,112,18],[79,6,113,4],[80,6,114,4],[80,12,114,10,"initUser"],[80,20,114,18],[80,23,114,21],[80,29,114,21,"initUser"],[80,30,114,21],[80,35,114,33],[81,8,115,6],[81,12,115,10],[82,10,116,8],[82,16,116,14,"response"],[82,24,116,22],[82,27,116,25],[82,33,116,31,"fetch"],[82,38,116,36],[82,39,116,37],[82,42,116,40,"API_URL"],[82,49,116,47],[82,61,116,59],[82,63,116,61],[83,12,117,10,"method"],[83,18,117,16],[83,20,117,18],[83,26,117,24],[84,12,118,10,"headers"],[84,19,118,17],[84,21,118,19],[85,14,118,21],[85,28,118,35],[85,30,118,37],[86,12,118,56],[86,13,118,57],[87,12,119,10,"body"],[87,16,119,14],[87,18,119,16,"JSON"],[87,22,119,20],[87,23,119,21,"stringify"],[87,32,119,30],[87,33,119,31],[88,14,119,33,"username"],[88,22,119,41],[88,24,119,43],[89,12,119,50],[89,13,119,51],[90,10,120,8],[90,11,120,9],[90,12,120,10],[91,10,121,8],[91,16,121,14,"data"],[91,20,121,18],[91,23,121,21],[91,29,121,27,"response"],[91,37,121,35],[91,38,121,36,"json"],[91,42,121,40],[91,43,121,41],[91,44,121,42],[92,10,122,8,"setUser"],[92,17,122,15],[92,18,122,16,"data"],[92,22,122,20],[92,23,122,21],[93,8,123,6],[93,9,123,7],[93,10,123,8],[93,17,123,15,"error"],[93,22,123,20],[93,24,123,22],[94,10,124,8,"console"],[94,17,124,15],[94,18,124,16,"error"],[94,23,124,21],[94,24,124,22],[94,46,124,44],[94,48,124,46,"error"],[94,53,124,51],[94,54,124,52],[95,8,125,6],[95,9,125,7],[95,18,125,16],[96,10,126,8,"setLoading"],[96,20,126,18],[96,21,126,19],[96,26,126,24],[96,27,126,25],[97,8,127,6],[98,6,128,4],[98,7,128,5],[99,6,129,4,"initUser"],[99,14,129,12],[99,15,129,13],[99,16,129,14],[100,4,130,2],[100,5,130,3],[100,7,130,5],[100,9,130,7],[100,10,130,8],[102,4,132,2],[103,4,133,2],[103,8,133,2,"useEffect"],[103,14,133,11],[103,15,133,11,"useEffect"],[103,24,133,11],[103,26,133,12],[103,32,133,18],[104,6,134,4],[104,10,134,8,"user"],[104,14,134,12],[104,16,134,14,"id"],[104,18,134,16],[104,22,134,20],[104,23,134,21,"hasCheckedFailures"],[104,41,134,39],[104,43,134,41],[105,8,135,6,"setHasCheckedFailures"],[105,29,135,27],[105,30,135,28],[105,34,135,32],[105,35,135,33],[106,8,136,6],[107,8,137,6],[107,14,137,12,"timer"],[107,19,137,17],[107,22,137,20,"setTimeout"],[107,32,137,30],[107,33,137,31],[107,39,137,37],[108,10,138,8,"checkQuestFailures"],[108,28,138,26],[108,29,138,27],[108,30,138,28],[109,8,139,6],[109,9,139,7],[109,11,139,9],[109,15,139,13],[109,16,139,14],[110,8,140,6],[110,15,140,13],[110,21,140,19,"clearTimeout"],[110,33,140,31],[110,34,140,32,"timer"],[110,39,140,37],[110,40,140,38],[111,6,141,4],[112,4,142,2],[112,5,142,3],[112,7,142,5],[112,8,142,6,"user"],[112,12,142,10],[112,14,142,12,"id"],[112,16,142,14],[112,18,142,16,"hasCheckedFailures"],[112,36,142,34],[112,37,142,35],[112,38,142,36],[113,4,144,2],[113,24,145,4],[113,28,145,4,"_reactJsxDevRuntime"],[113,47,145,4],[113,48,145,4,"jsxDEV"],[113,54,145,4],[113,56,145,5,"UserContext"],[113,67,145,16],[113,68,145,17,"Provider"],[113,76,145,25],[114,6,145,26,"value"],[114,11,145,31],[114,13,145,33],[115,8,146,6,"user"],[115,12,146,10],[116,8,147,6,"loading"],[116,15,147,13],[117,8,148,6,"refreshUser"],[117,19,148,17],[118,8,149,6,"createUser"],[118,18,149,16],[119,8,150,6,"failureData"],[119,19,150,17],[120,8,151,6,"showFailureModal"],[120,24,151,22],[121,8,152,6,"dismissFailureModal"],[121,27,152,25],[122,8,153,6,"checkQuestFailures"],[123,6,154,4],[123,7,154,6],[124,6,154,6,"children"],[124,14,154,6],[124,16,155,7,"children"],[125,4,155,15],[126,6,155,15,"fileName"],[126,14,155,15],[126,16,155,15,"_jsxFileName"],[126,28,155,15],[127,6,155,15,"lineNumber"],[127,16,155,15],[128,6,155,15,"columnNumber"],[128,18,155,15],[129,4,155,15],[129,11,156,26],[129,12,156,27],[130,2,158,0],[131,2,160,7],[131,11,160,16,"useUser"],[131,18,160,23,"useUser"],[131,19,160,23],[131,21,160,26],[132,4,161,2],[132,10,161,8,"context"],[132,17,161,15],[132,20,161,18],[132,24,161,18,"useContext"],[132,30,161,28],[132,31,161,28,"useContext"],[132,41,161,28],[132,43,161,29,"UserContext"],[132,54,161,40],[132,55,161,41],[133,4,162,2],[133,8,162,6,"context"],[133,15,162,13],[133,20,162,18,"undefined"],[133,29,162,27],[133,31,162,29],[134,6,163,4],[134,12,163,10],[134,16,163,14,"Error"],[134,21,163,19],[134,22,163,20],[134,66,163,64],[134,67,163,65],[135,4,164,2],[136,4,165,2],[136,11,165,9,"context"],[136,18,165,16],[137,2,166,0],[138,0,166,1],[138,3]],"functionMap":{"names":["<global>","UserProvider","createUser","refreshUser","checkQuestFailures","dismissFailureModal","useEffect$argument_0","initUser","setTimeout$argument_0","<anonymous>","useUser"],"mappings":"AAA;OCkD;qBCO;GDY;sBEE;GFS;6BGG;GHqB;8BIE;GJG;YKE;qBCE;KDc;GLE;YKG;+BEI;OFE;aGC,yBH;GLE;CDgB;OUE;CVM"},"hasCjsExports":false},"type":"js/module"}]}